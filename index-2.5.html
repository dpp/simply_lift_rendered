<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">  <head>    <title>      Simply Lift    </title>    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />    <!-- scripts for highlighter -->    <script type="text/javascript" src="scripts/shCore.js"></script>    <script type="text/javascript" src="scripts/shBrushXml.js"></script>    <script type="text/javascript" src="scripts/shBrushScala.js"></script>    <script type="text/javascript" src="scripts/shBrushBash.js"></script>    <!-- CSS for highlighter -->    <link href="css/shCore.css" rel="stylesheet" type="text/css" />    <link href="css/shThemeDefault.css" rel="stylesheet" type="text/css" />    <link rel="stylesheet" href="css/lyx.css" type="text/css" media="screen"/>  </head>  <body>    <div id="globalWrapper">      <div class="splitheader">
<span class="prev"><a class="prev" name="prev" href="index-2.4.html#Next">Previous: Section 2.4</a></span>
<span class="up"><a class="up" href="index-Chapter-2.html">Up: Chapter 2</a></span>
<span class="next"><a class="next" name="Next" href="index-2.6.html#prev">Next: Section 2.6</a></span>
</div>
<h2 class="Section">
<a class="toc" name="toc-Section-2.5">2.5</a> Chat In
</h2>
<div class="Standard">
The <tt>ChatIn</tt> snippet (See <a class="Reference" href="index-7.1.html#sec:Snippets">↓</a>) is defined as:
</div>
<div class="Standard">

</div>
<div class="listing">
<div class="caption">
ChatIn.scala
</div>
<pre class="listing brush: scala">package code
package snippet
​
import net.liftweb._
import http._
import js._
import JsCmds._
import JE._
​
import comet.ChatServer
​
/**
 * A snippet transforms input to output... it transforms
 * templates to dynamic content.  Lift's templates can invoke
 * snippets and the snippets are resolved in many different
 * ways including "by convention".  The snippet package
 * has named snippets and those snippets can be classes
 * that are instantiated when invoked or they can be
 * objects, singletons.  Singletons are useful if there's
 * no explicit state managed in the snippet.
 */
object ChatIn {
​
  /**
   * The render method in this case returns a function
   * that transforms NodeSeq => NodeSeq.  In this case,
   * the function transforms a form input element by attaching
   * behavior to the input.  The behavior is to send a message
   * to the ChatServer and then returns JavaScript which
   * clears the input.
   */
  def render = SHtml.onSubmit(s => {
    ChatServer ! s
    SetValById("chat_in", "")
  })
}
</pre>
</div>
<div class="Standard">
The code is very simple. The snippet is defined as a method that associates a function with form element submission, <tt>onSubmit</tt>. When the element is submitted, be that normal form submission, Ajax, or whatever, the function is applied to the value of the form. In English, when the user submits the form, the function is called with the user’s input.
</div>
<div class="Standard">
The function sends the input as a message to the <tt>ChatServer</tt> and returns JavaScript that sets the value of the input box to a blank string.
</div>
<div class="splitheader">
<span class="prev"><a class="prev" name="prev" href="index-2.4.html#Next">Previous: Section 2.4</a></span>
<span class="up"><a class="up" href="index-Chapter-2.html">Up: Chapter 2</a></span>
<span class="next"><a class="next" name="Next" href="index-2.6.html#prev">Next: Section 2.6</a></span>
</div>
          <p class="bottom">(C) 2012 David Pollak</p>    </div>    <script type="text/javascript">SyntaxHighlighter.all()</script>  </body></html>